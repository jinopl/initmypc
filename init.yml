---
- name: Setup my pc
  hosts: all
  become: yes

  tasks:
    - name: fail when system is not debian based
      fail:
        msg: "Sorry system is not debian based"
      when: ansible_facts['os_family'] != "Debian"

    - name: installing python-apt for package management
      apt:
        name: python-apt
        state: present

    - name: Updating repo's
      apt:
        update_cache: yes
        cache_valid_time: 3600

    - name: Update all packages to their latest version
      apt:
        name: "*"
        state: latest

    - name: install essential packages
      apt:
        name:
          - ssh
          - vim
          - htop
          - neofetch
          - gdebi
          - flameshot
          - git
          - cowsay
        state: present

    - name: Install GPG keys for softwares
      apt_key:
        url: "{{ item }}"
        state: present
      with_items:
        - https://download.sublimetext.com/sublimehq-pub.gpg

    - name: Adding repositories to system
      apt_repository:
        repo: deb https://download.sublimetext.com/ apt/stable/
        filename: sublime
        state: present

    - name: install sublime 
      apt:
        name: sublime-text
        state: present
        update_cache: yes
